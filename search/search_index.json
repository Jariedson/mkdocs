{"config":{"lang":["en"],"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"Welcome to MkDocs For full documentation visit mkdocs.org . Commands mkdocs new [dir-name] - Create a new project. mkdocs serve - Start the live-reloading docs server. mkdocs build - Build the documentation site. mkdocs help - Print this help message. Project layout 1 2 3 4 mkdocs.yml # The configuration file. docs/ index.md # The documentation homepage. ... # Other markdown pages, images and other files. Teste de cor some blue text .","title":"Home"},{"location":"#welcome-to-mkdocs","text":"For full documentation visit mkdocs.org .","title":"Welcome to MkDocs"},{"location":"#commands","text":"mkdocs new [dir-name] - Create a new project. mkdocs serve - Start the live-reloading docs server. mkdocs build - Build the documentation site. mkdocs help - Print this help message.","title":"Commands"},{"location":"#project-layout","text":"1 2 3 4 mkdocs.yml # The configuration file. docs/ index.md # The documentation homepage. ... # Other markdown pages, images and other files.","title":"Project layout"},{"location":"#teste-de-cor","text":"some blue text .","title":"Teste de cor"},{"location":"Linux/","text":"Dicas Linux Documenta\u00e7\u00e3o com dicas sobre o Linux Aumentar o swap no Linux No exemplo a seguir, ser\u00e1 criado um arquico com 1 GB de tamanho que ser\u00e1 usado como swap. 1 # dd if=/dev/zero of=/root/novo_swap bs=1M count=1024 Vamos definir permiss\u00f5es de acesso para somente o root. 1 # chmod 600 /root/novo_swap Vamos formatar o arquivo com o tipo swap. 1 # mkswap /root/novo_swap Use o seguinte comando para indicar o arquivo como incremento ao swap. 1 # swapon /root/novo_swap Fa\u00e7a com que o novo arquivo seja montado durante o boot 1 # echo \"/root/novo_swap none swap sw 0 0\" >> /etc/fstab Digite o seguinte comando para montar as parti\u00e7\u00f5es presentes no fstab. 1 # mount -a Problemas para atualizar reposit\u00f3rio php sury Apague o arquivo contendo o reposit\u00f3rio em '/etc/apt/sources.list.d/' Depois, digite os seguintes comandos para criar o novo reposit\u00f3rio 1 2 wget https://packages.sury.org/php/apt.gpg -O /etc/apt/trusted.gpg.d/php-sury.gpg echo \"deb https://packages.sury.org/php/ $(lsb_release -sc) main\" > /etc/apt/sources.list.d/php-sury.list","title":"Linux"},{"location":"Linux/#dicas-linux","text":"Documenta\u00e7\u00e3o com dicas sobre o Linux","title":"Dicas Linux"},{"location":"Linux/#aumentar-o-swap-no-linux","text":"No exemplo a seguir, ser\u00e1 criado um arquico com 1 GB de tamanho que ser\u00e1 usado como swap. 1 # dd if=/dev/zero of=/root/novo_swap bs=1M count=1024 Vamos definir permiss\u00f5es de acesso para somente o root. 1 # chmod 600 /root/novo_swap Vamos formatar o arquivo com o tipo swap. 1 # mkswap /root/novo_swap Use o seguinte comando para indicar o arquivo como incremento ao swap. 1 # swapon /root/novo_swap Fa\u00e7a com que o novo arquivo seja montado durante o boot 1 # echo \"/root/novo_swap none swap sw 0 0\" >> /etc/fstab Digite o seguinte comando para montar as parti\u00e7\u00f5es presentes no fstab. 1 # mount -a","title":"Aumentar o swap no Linux"},{"location":"Linux/#problemas-para-atualizar-repositorio-php-sury","text":"Apague o arquivo contendo o reposit\u00f3rio em '/etc/apt/sources.list.d/' Depois, digite os seguintes comandos para criar o novo reposit\u00f3rio 1 2 wget https://packages.sury.org/php/apt.gpg -O /etc/apt/trusted.gpg.d/php-sury.gpg echo \"deb https://packages.sury.org/php/ $(lsb_release -sc) main\" > /etc/apt/sources.list.d/php-sury.list","title":"Problemas para atualizar reposit\u00f3rio php sury"},{"location":"Windows/","text":"Dicas Windows Documenta\u00e7\u00e3o com dicas sobre o Windows Adicionar rota permanente no Windows No exemplo a seguir, ser\u00e1 criada uma rota para a rede 172.20.254.0/24 atrav\u00e9s do gateway 172.20.254.254 Execute o CMD como administrador e digite o seguinte comando 1 route add 172.20.254.0 mask 255.255.255.0 172.20.254.254 -p O par\u00e2metro -p foi usado para que a rota seja permanente, que n\u00e3o seja apagada quando o sistema for desligado. Modicificar o arquivo hosts Abra o bloco de notas como administrador e edite o serguinte arquivo C:\\Windows\\System32\\drivers\\etc\\hosts O arquivo deve ter a seguinte sintaxe 1 IP Nome do host","title":"Windows"},{"location":"Windows/#dicas-windows","text":"Documenta\u00e7\u00e3o com dicas sobre o Windows","title":"Dicas Windows"},{"location":"Windows/#adicionar-rota-permanente-no-windows","text":"No exemplo a seguir, ser\u00e1 criada uma rota para a rede 172.20.254.0/24 atrav\u00e9s do gateway 172.20.254.254 Execute o CMD como administrador e digite o seguinte comando 1 route add 172.20.254.0 mask 255.255.255.0 172.20.254.254 -p O par\u00e2metro -p foi usado para que a rota seja permanente, que n\u00e3o seja apagada quando o sistema for desligado.","title":"Adicionar rota permanente no Windows"},{"location":"Windows/#modicificar-o-arquivo-hosts","text":"Abra o bloco de notas como administrador e edite o serguinte arquivo C:\\Windows\\System32\\drivers\\etc\\hosts O arquivo deve ter a seguinte sintaxe 1 IP Nome do host","title":"Modicificar o arquivo hosts"},{"location":"about/","text":"Documenta\u00e7\u00e3o Particular criada em 24/05/2020","title":"About"},{"location":"bacula/","text":"Instala\u00e7\u00e3o do bacula atrav\u00e9s de script de instala\u00e7\u00e3o Use o seguinte comando para fazer download do script 1 wget -c https://raw.githubusercontent.com/wanderleihuttel/bacula-utils/master/conf/scripts/_bacula_community_package.sh -O /usr/local/bin/_bacula_community_install.sh D\u00ea permiss\u00e3o e execute o script 1 2 chmod a+x /usr/local/bin/_bacula_community_install.sh /usr/local/bin/_bacula_community_install.sh Nas pr\u00f3ximas telas, informe o seu ID (5f98339530de8), que \u00e9 fornecido no e-mail de cadastro no bacula community. 1 2 3 4 5 -------------------------------------------------- # Informe sua chave do Bacula # Esta chave \u00e9 obtida com o registro em Bacula.org # http://blog.bacula.org/download-community-binaries Please, fill with your Bacula Key: Depois, informe a vers\u00e3o a ser instalada. 1 2 3 4 5 6 7 8 9 10 11 12 13 # Este script s\u00f3 funcionar\u00e1 com as vers\u00f5es mais recentes do Debian e do CentOS -------------------------------------------------- Inform the Bacula version - 9.0.0 - 9.0.4 - 9.0.5 - 9.0.6 - 9.0.7 - 9.0.8 - 9.2.0 - 9.2.1 - 9.2.2 Choose your Bacula Version: Informe agora o banco que ser\u00e1 usado na instala\u00e7\u00e3o. 1 2 3 4 5 What do you want to do? 1) Install Bacula with PostgreSQL 2) Install Bacula with MySQL 3) Exit Select an option [1-3]: Aguarde a conclus\u00e3o do script e depois j\u00e1 ser\u00e1 poss\u00edvel iniciar a configura\u00e7\u00e3o do servidor. Configura\u00e7\u00e3o do Director","title":"Bacula"},{"location":"bacula/#instalacao-do-bacula-atraves-de-script-de-instalacao","text":"Use o seguinte comando para fazer download do script 1 wget -c https://raw.githubusercontent.com/wanderleihuttel/bacula-utils/master/conf/scripts/_bacula_community_package.sh -O /usr/local/bin/_bacula_community_install.sh D\u00ea permiss\u00e3o e execute o script 1 2 chmod a+x /usr/local/bin/_bacula_community_install.sh /usr/local/bin/_bacula_community_install.sh Nas pr\u00f3ximas telas, informe o seu ID (5f98339530de8), que \u00e9 fornecido no e-mail de cadastro no bacula community. 1 2 3 4 5 -------------------------------------------------- # Informe sua chave do Bacula # Esta chave \u00e9 obtida com o registro em Bacula.org # http://blog.bacula.org/download-community-binaries Please, fill with your Bacula Key: Depois, informe a vers\u00e3o a ser instalada. 1 2 3 4 5 6 7 8 9 10 11 12 13 # Este script s\u00f3 funcionar\u00e1 com as vers\u00f5es mais recentes do Debian e do CentOS -------------------------------------------------- Inform the Bacula version - 9.0.0 - 9.0.4 - 9.0.5 - 9.0.6 - 9.0.7 - 9.0.8 - 9.2.0 - 9.2.1 - 9.2.2 Choose your Bacula Version: Informe agora o banco que ser\u00e1 usado na instala\u00e7\u00e3o. 1 2 3 4 5 What do you want to do? 1) Install Bacula with PostgreSQL 2) Install Bacula with MySQL 3) Exit Select an option [1-3]: Aguarde a conclus\u00e3o do script e depois j\u00e1 ser\u00e1 poss\u00edvel iniciar a configura\u00e7\u00e3o do servidor.","title":"Instala\u00e7\u00e3o do bacula atrav\u00e9s de script de instala\u00e7\u00e3o"},{"location":"bacula/#configuracao-do-director","text":"","title":"Configura\u00e7\u00e3o do Director"},{"location":"cisco/","text":"Configurar NTP Para configurar o ntp como um nome \u00e9 preciso antes configurar o dns do switch 1 2 3 4 Swt# configure terminal Swt(config)# ip name-server 8.8.8.8 Swt(config)# end Swt# copy running-config startup-config Depois de configurar o dns do switch \u00e9 poss\u00edvel configurar o ntp por nome 1 2 3 4 5 6 7 Swt# configure terminal Swt(config)# ntp server pool.ntp.br Swt(config)# clock timezone BR -3 0 Swt(config)# exit Swt# show ntp associations Swt# show clock Swt# copy running-config startup-config Configurar link-aggregation Antes de iniciar a configura\u00e7\u00e3o, retorne as interfaces usadas para o estado inicial da seguinte forma: 1 2 Swt(config)# default interface gigabitEthernet 0/21 Swt(config-if)# default interface gigabitEthernet 0/22 Depois, inicie a configura\u00e7\u00e3o do link aggregation 1 2 3 4 5 6 7 8 Swt(config)# interface gigabitethernet0/21 Swt(config-if)# channel-group 1 mode passive Swt(config-if)# channel-protocol lacp Swt(config-if)# exit Swt(config)# interface gigabitethernet0/22 Swt(config-if)# channel-group 1 mode passive Swt(config-if)# channel-protocol lacp Swt(config-if)# exit Agora, configure a interface em modo trunk e informe as vlans que pasar\u00e3o por ela 1 2 3 4 5 6 7 Swt# conf t Swt(config)# interface Port-channel 1 Swt(config)# switchport mode trunk Swt(config-if)# switchport trunk native vlan 1 Swt(config-if)# switchport trunk allowed vlan add 1,100,200 Swt(config-if)# exit Swt(config)# do wr Configurar SNMP No switch, crie a comunidade com permiss\u00e3o de leitura, defina o e-mail de contato e a localiza\u00e7\u00e3o do equipamento 1 2 3 4 5 6 Swt# conf t Swt(config)# snmp-server community it-manager ro Swt(config)# snmp-server contact Admin-Network <admin-network@domain.lan> Swt(config)# snmp-server location it room Swt(config)# exit Swt# copy running-config startup-config","title":"Cisco"},{"location":"cisco/#configurar-ntp","text":"Para configurar o ntp como um nome \u00e9 preciso antes configurar o dns do switch 1 2 3 4 Swt# configure terminal Swt(config)# ip name-server 8.8.8.8 Swt(config)# end Swt# copy running-config startup-config Depois de configurar o dns do switch \u00e9 poss\u00edvel configurar o ntp por nome 1 2 3 4 5 6 7 Swt# configure terminal Swt(config)# ntp server pool.ntp.br Swt(config)# clock timezone BR -3 0 Swt(config)# exit Swt# show ntp associations Swt# show clock Swt# copy running-config startup-config","title":"Configurar NTP"},{"location":"cisco/#configurar-link-aggregation","text":"Antes de iniciar a configura\u00e7\u00e3o, retorne as interfaces usadas para o estado inicial da seguinte forma: 1 2 Swt(config)# default interface gigabitEthernet 0/21 Swt(config-if)# default interface gigabitEthernet 0/22 Depois, inicie a configura\u00e7\u00e3o do link aggregation 1 2 3 4 5 6 7 8 Swt(config)# interface gigabitethernet0/21 Swt(config-if)# channel-group 1 mode passive Swt(config-if)# channel-protocol lacp Swt(config-if)# exit Swt(config)# interface gigabitethernet0/22 Swt(config-if)# channel-group 1 mode passive Swt(config-if)# channel-protocol lacp Swt(config-if)# exit Agora, configure a interface em modo trunk e informe as vlans que pasar\u00e3o por ela 1 2 3 4 5 6 7 Swt# conf t Swt(config)# interface Port-channel 1 Swt(config)# switchport mode trunk Swt(config-if)# switchport trunk native vlan 1 Swt(config-if)# switchport trunk allowed vlan add 1,100,200 Swt(config-if)# exit Swt(config)# do wr","title":"Configurar link-aggregation"},{"location":"cisco/#configurar-snmp","text":"No switch, crie a comunidade com permiss\u00e3o de leitura, defina o e-mail de contato e a localiza\u00e7\u00e3o do equipamento 1 2 3 4 5 6 Swt# conf t Swt(config)# snmp-server community it-manager ro Swt(config)# snmp-server contact Admin-Network <admin-network@domain.lan> Swt(config)# snmp-server location it room Swt(config)# exit Swt# copy running-config startup-config","title":"Configurar SNMP"},{"location":"guacamole/","text":"Instale o tomcat 9 1 # apt install tomcat9 tomcat9-admin tomcat9-common tomcat9-user Instala\u00e7\u00e3o do Guacamole Server Instale as depend\u00eancias 1 # apt install build-essential libcairo2-dev libjpeg62-turbo-dev libtool-bin libossp-uuid-dev libavcodec-dev libavutil-dev libswscale-dev freerdp2-dev libpango1.0-dev libssh2-1-dev libtelnet-dev libvncserver-dev libwebsockets-dev libpulse-dev libssl-dev libvorbis-dev libwebp-dev Fa\u00e7a download do pacote 1 2 # url='http://apache.org/dyn/closer.cgi?action=download&filename=guacamole/1.2.0/source/guacamole-server-1.2.0.tar.gz' # wget $url -O guacamole-server.tar.gz Descompacte o pacote 1 # tar -xvf guacamole-server.tar.gz Entre no diret\u00f3rio do guacamole e fa\u00e7a a instala\u00e7\u00e3o 1 2 3 4 # cd guacamole-server-1.2.0 # ./configure --with-init-dir=/etc/init.d # make ; make install # ldconfig Ative a inicializa\u00e7\u00e3o no boot e start o servi\u00e7o 1 2 # systemctl enable guacd # systemctl start guacd Configura\u00e7\u00e3o do Guacamole Client Fa\u00e7a download do client 1 2 3 4 5 6 7 # site='http://apache.org/dyn/closer.cgi?action=download&filename=guacamole/1.2.0/binary/guacamole-1.2.0.war' # wget $site -O guacamole.war # mkdir /etc/guacamole # cp guacamole.war /etc/guacamole/guacamole.war # ln -s /etc/guacamole/guacamole.war /var/lib/tomcat9/webapps/ # mkdir /etc/guacamole/{extensions,lib} # echo \"GUACAMOLE_HOME=/etc/guacamole\" | tee -a /etc/default/tomcat9 Instale o banco de dados 1 # apt install mariadb-server mariadb-client Crie o banco de dados e o usu\u00e1rio para acessar o banco 1 2 3 4 5 6 # mysql -p # CREATE DATABASE guacamole_db; # CREATE USER 'guacamole_user'@'localhost' IDENTIFIED BY 'passw0rd'; # GRANT SELECT,INSERT,UPDATE,DELETE ON guacamole_db.* TO 'guacamole_user'@'localhost'; # FLUSH PRIVILEGES; # quit; Fa\u00e7a o download do jdbc-extension 1 2 # wget http://apache.mirror.digionline.de/guacamole/1.2.0/binary/guacamole-auth-jdbc-1.2.0.tar.gz # tar vfx guacamole-auth-jdbc-1.2.0.tar.gz Importe a base de dados 1 # cat guacamole-auth-jdbc-1.2.0/mysql/schema/*.sql | mysql -u root -p guacamole_db Instale a extens\u00e3o 1 # cp guacamole-auth-jdbc-1.2.0/mysql/guacamole-auth-jdbc-mysql-1.2.0.jar /etc/guacamole/extensions/ Instale o driver JDBC 1 2 3 4 5 # wget https://dev.mysql.com/get/Downloads/Connector-J/mysql-connector-java-8.0.13.tar.gz # tar xvzf mysql-connector-java-8.0.13.tar.gz # cp mysql-connector-java-8.0.13/mysql-connector-java-8.0.13.jar /etc/guacamole/lib/ Configure o timezone do banco de dados 1 # mysql_tzinfo_to_sql /usr/share/zoneinfo | mysql -u root -p mysql Edite o arquivo /etc/mysql/mariadb.conf.d/50-server.cnf e adicione o seguinte conte\u00fado 1 # default_time_zone='America/Recife' Reinicie o banco de dados 1 # systemctl restart mariadb.service Configure o Guacamole Edite o arquivo /etc/guacamole/guacamole.properties e adicione o seguinte conte\u00fado 1 2 3 4 5 6 7 8 9 10 # Hostname and Guacamole server port guacd-hostname: localhost guacd-port: 4822 # MySQL properties mysql-hostname: localhost mysql-port: 3306 mysql-database: guacamole_db mysql-username: guacamole_user mysql-password: passw0rd Reinicie os servi\u00e7os 1 2 # systemctl restart tomcat9 # systemctl restart guacd Acesse o seguinte endere\u00e7o http://IP_SERVER:8080/guacamole O usu\u00e1rio e senha s\u00e3o guacadmin e guacadmin Configure a autentica\u00e7\u00e3o LDAP Baixe a extens\u00e3o 1 2 3 # wget https://downloads.apache.org/guacamole/1.2.0/binary/guacamole-auth-ldap-1.2.0.tar.gz # tar xvf guacamole-auth-ldap-1.2.0.tar.gz # cp guacamole-auth-ldap-1.2.0/guacamole-auth-ldap-1.2.0.jar /etc/guacamole/extensions/ Adicione o seguinte conte\u00fado ao arquivo /etc/guacamole/guacamole.properties 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 ### LDAP ### ldap-hostname:ldap.domain.lan # IP ou nome do servidor ldap ldap-port:389 ldap-encryption-method: none ldap-search-bind-dn:CN=leitor-guacamole,OU=SERVICES,DC=domain,DC=lan # Usu\u00e1rio com permiss\u00e3o de leitura na base ldap ldap-search-bind-password:XXXsenhaXXX ldap-user-base-dn:DC=domain,DC=lan # Onde buscar os usu\u00e1rios ldap-group-base-dn:OU=GROUPS,DC=domain,DC=lan # Onde o guacamole ir\u00e1 buscar os grupos ldap-group-name-attribute:cn ldap-username-attribute: sAMAccountName ldap-follow-referrals: false ldap-operation-timeout: 30 ldap-user-search-filter: (&(objectClass=user)(memberOf=CN=gg_guacamole_rdp,OU=GROUPS,DC=domain,DC=lan)) # Filtro para buscar apenas usu\u00e1rios que perten\u00e7am ao grupo gg_guacamole_rdp Prepare a base Ldap Crie os usu\u00e1rios leitor-guacamole e o grupo gg_guacamole_rdp Depois de criados os usu\u00e1rios, adicione um usu\u00e1rio do dom\u00ednio ao grupo gg_guacamole_rdp e fa\u00e7a login no sistema com o usu\u00e1rio padr\u00e3o guacadmin Configure os usu\u00e1rios no Guacamole Clique no canto superior direito, no nome guacadmin e depois em settings, clique agora em users e adicione o usu\u00e1rio que foi adicionado ao grupo gg_guacamole_rdp, n\u00e3o \u00e9 necess\u00e1rio colocar a senha. Marque todos os checkboxes da guia permissions. Fa\u00e7a logoff e, depois, login com o usu\u00e1rio rec\u00e9m criado. V\u00e1 na guia users e ver\u00e1 que todos os usu\u00e1rios do Ldap que, se adequam aos atributos configurados no filtro, estaram listados. Configure o proxy reverso 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 server { listen 80 ; server_name remoto.domain.lan ; access_log /var/log/nginx/remoto.domain.lan-access-80.log ; error_log /var/log/nginx/remoto.domain.lan-error.log ; include /etc/nginx/proxy_params ; location / { return 301 https : // $ host $ request_uri ; } } server { listen 443 ssl ; server_name remoto.domain.lan ; access_log /var/log/nginx/remoto.domain.lan-access-443.log ; error_log /var/log/nginx/remoto.domain.lan-error.log ; include /etc/nginx/ssl/domain_ssl_params ; include /etc/nginx/ssl/domain_ssl_crt ; include /etc/nginx/proxy_params ; location / { proxy_pass http : // IP_SERVER : 8080 / guacamole / ; proxy_buffering off ; proxy_http_version 1.2 ; proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for ; proxy_set_header Upgrade $http_upgrade ; proxy_set_header Connection $http_connection ; access_log off ; } }","title":"Guacamole"},{"location":"guacamole/#instale-o-tomcat-9","text":"1 # apt install tomcat9 tomcat9-admin tomcat9-common tomcat9-user","title":"Instale o tomcat 9"},{"location":"guacamole/#instalacao-do-guacamole-server","text":"Instale as depend\u00eancias 1 # apt install build-essential libcairo2-dev libjpeg62-turbo-dev libtool-bin libossp-uuid-dev libavcodec-dev libavutil-dev libswscale-dev freerdp2-dev libpango1.0-dev libssh2-1-dev libtelnet-dev libvncserver-dev libwebsockets-dev libpulse-dev libssl-dev libvorbis-dev libwebp-dev Fa\u00e7a download do pacote 1 2 # url='http://apache.org/dyn/closer.cgi?action=download&filename=guacamole/1.2.0/source/guacamole-server-1.2.0.tar.gz' # wget $url -O guacamole-server.tar.gz Descompacte o pacote 1 # tar -xvf guacamole-server.tar.gz Entre no diret\u00f3rio do guacamole e fa\u00e7a a instala\u00e7\u00e3o 1 2 3 4 # cd guacamole-server-1.2.0 # ./configure --with-init-dir=/etc/init.d # make ; make install # ldconfig Ative a inicializa\u00e7\u00e3o no boot e start o servi\u00e7o 1 2 # systemctl enable guacd # systemctl start guacd","title":"Instala\u00e7\u00e3o do Guacamole Server"},{"location":"guacamole/#configuracao-do-guacamole-client","text":"Fa\u00e7a download do client 1 2 3 4 5 6 7 # site='http://apache.org/dyn/closer.cgi?action=download&filename=guacamole/1.2.0/binary/guacamole-1.2.0.war' # wget $site -O guacamole.war # mkdir /etc/guacamole # cp guacamole.war /etc/guacamole/guacamole.war # ln -s /etc/guacamole/guacamole.war /var/lib/tomcat9/webapps/ # mkdir /etc/guacamole/{extensions,lib} # echo \"GUACAMOLE_HOME=/etc/guacamole\" | tee -a /etc/default/tomcat9","title":"Configura\u00e7\u00e3o do Guacamole Client"},{"location":"guacamole/#instale-o-banco-de-dados","text":"1 # apt install mariadb-server mariadb-client Crie o banco de dados e o usu\u00e1rio para acessar o banco 1 2 3 4 5 6 # mysql -p # CREATE DATABASE guacamole_db; # CREATE USER 'guacamole_user'@'localhost' IDENTIFIED BY 'passw0rd'; # GRANT SELECT,INSERT,UPDATE,DELETE ON guacamole_db.* TO 'guacamole_user'@'localhost'; # FLUSH PRIVILEGES; # quit; Fa\u00e7a o download do jdbc-extension 1 2 # wget http://apache.mirror.digionline.de/guacamole/1.2.0/binary/guacamole-auth-jdbc-1.2.0.tar.gz # tar vfx guacamole-auth-jdbc-1.2.0.tar.gz Importe a base de dados 1 # cat guacamole-auth-jdbc-1.2.0/mysql/schema/*.sql | mysql -u root -p guacamole_db Instale a extens\u00e3o 1 # cp guacamole-auth-jdbc-1.2.0/mysql/guacamole-auth-jdbc-mysql-1.2.0.jar /etc/guacamole/extensions/ Instale o driver JDBC 1 2 3 4 5 # wget https://dev.mysql.com/get/Downloads/Connector-J/mysql-connector-java-8.0.13.tar.gz # tar xvzf mysql-connector-java-8.0.13.tar.gz # cp mysql-connector-java-8.0.13/mysql-connector-java-8.0.13.jar /etc/guacamole/lib/ Configure o timezone do banco de dados 1 # mysql_tzinfo_to_sql /usr/share/zoneinfo | mysql -u root -p mysql Edite o arquivo /etc/mysql/mariadb.conf.d/50-server.cnf e adicione o seguinte conte\u00fado 1 # default_time_zone='America/Recife' Reinicie o banco de dados 1 # systemctl restart mariadb.service","title":"Instale o banco de dados"},{"location":"guacamole/#configure-o-guacamole","text":"Edite o arquivo /etc/guacamole/guacamole.properties e adicione o seguinte conte\u00fado 1 2 3 4 5 6 7 8 9 10 # Hostname and Guacamole server port guacd-hostname: localhost guacd-port: 4822 # MySQL properties mysql-hostname: localhost mysql-port: 3306 mysql-database: guacamole_db mysql-username: guacamole_user mysql-password: passw0rd Reinicie os servi\u00e7os 1 2 # systemctl restart tomcat9 # systemctl restart guacd Acesse o seguinte endere\u00e7o http://IP_SERVER:8080/guacamole O usu\u00e1rio e senha s\u00e3o guacadmin e guacadmin","title":"Configure o Guacamole"},{"location":"guacamole/#configure-a-autenticacao-ldap","text":"Baixe a extens\u00e3o 1 2 3 # wget https://downloads.apache.org/guacamole/1.2.0/binary/guacamole-auth-ldap-1.2.0.tar.gz # tar xvf guacamole-auth-ldap-1.2.0.tar.gz # cp guacamole-auth-ldap-1.2.0/guacamole-auth-ldap-1.2.0.jar /etc/guacamole/extensions/ Adicione o seguinte conte\u00fado ao arquivo /etc/guacamole/guacamole.properties 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 ### LDAP ### ldap-hostname:ldap.domain.lan # IP ou nome do servidor ldap ldap-port:389 ldap-encryption-method: none ldap-search-bind-dn:CN=leitor-guacamole,OU=SERVICES,DC=domain,DC=lan # Usu\u00e1rio com permiss\u00e3o de leitura na base ldap ldap-search-bind-password:XXXsenhaXXX ldap-user-base-dn:DC=domain,DC=lan # Onde buscar os usu\u00e1rios ldap-group-base-dn:OU=GROUPS,DC=domain,DC=lan # Onde o guacamole ir\u00e1 buscar os grupos ldap-group-name-attribute:cn ldap-username-attribute: sAMAccountName ldap-follow-referrals: false ldap-operation-timeout: 30 ldap-user-search-filter: (&(objectClass=user)(memberOf=CN=gg_guacamole_rdp,OU=GROUPS,DC=domain,DC=lan)) # Filtro para buscar apenas usu\u00e1rios que perten\u00e7am ao grupo gg_guacamole_rdp","title":"Configure a autentica\u00e7\u00e3o LDAP"},{"location":"guacamole/#prepare-a-base-ldap","text":"Crie os usu\u00e1rios leitor-guacamole e o grupo gg_guacamole_rdp Depois de criados os usu\u00e1rios, adicione um usu\u00e1rio do dom\u00ednio ao grupo gg_guacamole_rdp e fa\u00e7a login no sistema com o usu\u00e1rio padr\u00e3o guacadmin","title":"Prepare a base Ldap"},{"location":"guacamole/#configure-os-usuarios-no-guacamole","text":"Clique no canto superior direito, no nome guacadmin e depois em settings, clique agora em users e adicione o usu\u00e1rio que foi adicionado ao grupo gg_guacamole_rdp, n\u00e3o \u00e9 necess\u00e1rio colocar a senha. Marque todos os checkboxes da guia permissions. Fa\u00e7a logoff e, depois, login com o usu\u00e1rio rec\u00e9m criado. V\u00e1 na guia users e ver\u00e1 que todos os usu\u00e1rios do Ldap que, se adequam aos atributos configurados no filtro, estaram listados.","title":"Configure os usu\u00e1rios no Guacamole"},{"location":"guacamole/#configure-o-proxy-reverso","text":"1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 server { listen 80 ; server_name remoto.domain.lan ; access_log /var/log/nginx/remoto.domain.lan-access-80.log ; error_log /var/log/nginx/remoto.domain.lan-error.log ; include /etc/nginx/proxy_params ; location / { return 301 https : // $ host $ request_uri ; } } server { listen 443 ssl ; server_name remoto.domain.lan ; access_log /var/log/nginx/remoto.domain.lan-access-443.log ; error_log /var/log/nginx/remoto.domain.lan-error.log ; include /etc/nginx/ssl/domain_ssl_params ; include /etc/nginx/ssl/domain_ssl_crt ; include /etc/nginx/proxy_params ; location / { proxy_pass http : // IP_SERVER : 8080 / guacamole / ; proxy_buffering off ; proxy_http_version 1.2 ; proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for ; proxy_set_header Upgrade $http_upgrade ; proxy_set_header Connection $http_connection ; access_log off ; } }","title":"Configure o proxy reverso"},{"location":"samba/","text":"Samba 4 Material utilizado para instalar e administrar o samba 4 como controlador de dom\u00ednio Neste tutorial foram usados os seguintes softwares: Debian 10 64 bits Samba 4.9.5 - Instalado via reposit\u00f3rio oficial do debian Samba 4 como controlador de dom\u00ednio adicional Altere o hostname do servidor 1 # hostnamectl set-hostname ad2 Adicione no /etc/hosts , uma entrada com o nome e IP da m\u00e1quina que ser\u00e1 adicionada como membro e do AD principal 1 2 10.0.99.10 ad2.domain.lan ad2 10.0.99.11 ad1.domain.lan ad1 Adicione o IP do ad principal ao arquivo /etc/resolv.conf 1 2 search domain.lan nameserver 10.0.99.11 Instale o pacote ntp 1 # apt install ntp Comente as entradas que cont\u00e9m os sevidores de nome e adicione as seguintes: 1 pool pool.ntp.br iburst Reinicie o servi\u00e7o e adicione sua inicializa\u00e7\u00e3o junto com o SO 1 2 # systemctl restart ntp # systemctl enable ntp Instale os seguintes pacotes 1 # apt install samba krb5-user krb5-config winbind libpam-winbind libnss-winbind Durante a instala\u00e7\u00e3o, ser\u00e1 pedido o nome krb5, que ser\u00e1 o nome do seu dom\u00ednio domain.lan Ap\u00f3s a instala\u00e7\u00e3o, fa\u00e7a o teste para ver se o servidor est\u00e1 conseguindo tickets do servidor principal 1 # kinit administrator@domain.lan Verifique se o servidor conseguiu o ticket 1 # klist Se o servidor conseguir o ticket, pare os servi\u00e7os associados ao samba 1 # systemctl stop samba-ad-dc smbd nmbd winbind Renomeie o arquivo original do samba 1 # mv /etc/samba/smb.conf /etc/samba/smb.original Adicione o servidor como DC secund\u00e1rio 1 # samba-tool domain join domain.lan DC -U\"administrator\" --dns-backend=SAMBA_INTERNAL O dns interno do samba \u00e9 bem limitado e n\u00e3o \u00e9 recursivo, para fazer com que os hosts, que usam o samba para acessar \u00e0 internet ou outros nomes, que o samba n\u00e3o conhece, \u00e9 necess\u00e1rio adicionar a seguinte linha ao arquivo /etc/samba/smb.conf 1 # dns forwarder = 8.8.8.8 Restarte o servi\u00e7o do samba 1 # systemctl restart samba-ad-dc Use o seguinte comando para verificar a replica\u00e7\u00e3o os dados 1 # samba-tool drs showrepl Copie o arquivo de configura\u00e7\u00e3o do kerberos criado pelo samba para o diret\u00f3rio /etc 1 2 # mv /etc/krb5.conf /etc/krb5.original # ln -s /var/lib/samba/private/krb5.conf /etc/ Valide as entradas dns do samba 1 2 3 # host domain.lan # host -t SRV _kerberos._udp.domain.lan # host -t SRV _ldap._tcp.domain.lan O comando anterior dever\u00e1 ter como sa\u00edda algo parecido com isso 1 2 3 4 5 6 7 8 9 root@ad2# host domain.lan root@ad2# domain.lan has address 10.0.99.10 root@ad2# domain.lan has address 10.0.99.11 root@ad2# host -t SRV _ldap._tcp.domain.lan root@ad2# _ldap._tcp.domain.lan has SRV record 0 100 389 ad1.domain.lan root@ad2# _ldap._tcp.domain.lan has SRV record 0 100 389 ad2.domain.lan root@ad2# host -t SRV _kerberos._udp.domain.lan root@ad2# _kerberos._udp.domain.lan has SRV record 0 100 88 ad1.domain.lan root@ad2# _kerberos._udp.domain.lan has SRV record 0 100 88 ad2.domain.lan Desabilite os servi\u00e7os que n\u00e3o ser\u00e3o necess\u00e1rios e habilite o samba para iniciar junto com o SO 1 2 # systemctl disable smbd nmbd winbind # systemctl enable samba-ad-dc","title":"Controladores de Dom\u00ednio"},{"location":"samba/#samba-4","text":"Material utilizado para instalar e administrar o samba 4 como controlador de dom\u00ednio Neste tutorial foram usados os seguintes softwares: Debian 10 64 bits Samba 4.9.5 - Instalado via reposit\u00f3rio oficial do debian","title":"Samba 4"},{"location":"samba/#samba-4-como-controlador-de-dominio-adicional","text":"Altere o hostname do servidor 1 # hostnamectl set-hostname ad2 Adicione no /etc/hosts , uma entrada com o nome e IP da m\u00e1quina que ser\u00e1 adicionada como membro e do AD principal 1 2 10.0.99.10 ad2.domain.lan ad2 10.0.99.11 ad1.domain.lan ad1 Adicione o IP do ad principal ao arquivo /etc/resolv.conf 1 2 search domain.lan nameserver 10.0.99.11 Instale o pacote ntp 1 # apt install ntp Comente as entradas que cont\u00e9m os sevidores de nome e adicione as seguintes: 1 pool pool.ntp.br iburst Reinicie o servi\u00e7o e adicione sua inicializa\u00e7\u00e3o junto com o SO 1 2 # systemctl restart ntp # systemctl enable ntp Instale os seguintes pacotes 1 # apt install samba krb5-user krb5-config winbind libpam-winbind libnss-winbind Durante a instala\u00e7\u00e3o, ser\u00e1 pedido o nome krb5, que ser\u00e1 o nome do seu dom\u00ednio domain.lan Ap\u00f3s a instala\u00e7\u00e3o, fa\u00e7a o teste para ver se o servidor est\u00e1 conseguindo tickets do servidor principal 1 # kinit administrator@domain.lan Verifique se o servidor conseguiu o ticket 1 # klist Se o servidor conseguir o ticket, pare os servi\u00e7os associados ao samba 1 # systemctl stop samba-ad-dc smbd nmbd winbind Renomeie o arquivo original do samba 1 # mv /etc/samba/smb.conf /etc/samba/smb.original Adicione o servidor como DC secund\u00e1rio 1 # samba-tool domain join domain.lan DC -U\"administrator\" --dns-backend=SAMBA_INTERNAL O dns interno do samba \u00e9 bem limitado e n\u00e3o \u00e9 recursivo, para fazer com que os hosts, que usam o samba para acessar \u00e0 internet ou outros nomes, que o samba n\u00e3o conhece, \u00e9 necess\u00e1rio adicionar a seguinte linha ao arquivo /etc/samba/smb.conf 1 # dns forwarder = 8.8.8.8 Restarte o servi\u00e7o do samba 1 # systemctl restart samba-ad-dc Use o seguinte comando para verificar a replica\u00e7\u00e3o os dados 1 # samba-tool drs showrepl Copie o arquivo de configura\u00e7\u00e3o do kerberos criado pelo samba para o diret\u00f3rio /etc 1 2 # mv /etc/krb5.conf /etc/krb5.original # ln -s /var/lib/samba/private/krb5.conf /etc/ Valide as entradas dns do samba 1 2 3 # host domain.lan # host -t SRV _kerberos._udp.domain.lan # host -t SRV _ldap._tcp.domain.lan O comando anterior dever\u00e1 ter como sa\u00edda algo parecido com isso 1 2 3 4 5 6 7 8 9 root@ad2# host domain.lan root@ad2# domain.lan has address 10.0.99.10 root@ad2# domain.lan has address 10.0.99.11 root@ad2# host -t SRV _ldap._tcp.domain.lan root@ad2# _ldap._tcp.domain.lan has SRV record 0 100 389 ad1.domain.lan root@ad2# _ldap._tcp.domain.lan has SRV record 0 100 389 ad2.domain.lan root@ad2# host -t SRV _kerberos._udp.domain.lan root@ad2# _kerberos._udp.domain.lan has SRV record 0 100 88 ad1.domain.lan root@ad2# _kerberos._udp.domain.lan has SRV record 0 100 88 ad2.domain.lan Desabilite os servi\u00e7os que n\u00e3o ser\u00e3o necess\u00e1rios e habilite o samba para iniciar junto com o SO 1 2 # systemctl disable smbd nmbd winbind # systemctl enable samba-ad-dc","title":"Samba 4 como controlador de dom\u00ednio adicional"},{"location":"xen/","text":"Xen - XCP-ng Documenta\u00e7\u00e3o com dicas sobre o Xcp-ng Instalar xen-tools no Linux 1 2 3 4 # mkdir -p /mnt/xen-tools # mount /dev/cdrom /mnt/xen-tools # ./install.sh # reboot","title":"Xen"},{"location":"xen/#xen-xcp-ng","text":"Documenta\u00e7\u00e3o com dicas sobre o Xcp-ng","title":"Xen - XCP-ng"},{"location":"xen/#instalar-xen-tools-no-linux","text":"1 2 3 4 # mkdir -p /mnt/xen-tools # mount /dev/cdrom /mnt/xen-tools # ./install.sh # reboot","title":"Instalar xen-tools no Linux"},{"location":"zabbix/","text":"Instala\u00e7\u00e3o do agente zabbix em servidores Linux Debian Instale o reposit\u00f3rio 1 2 3 4 # url='https://repo.zabbix.com/zabbix/4.5/debian/pool/main/z/zabbix-release/zabbix-release_4.5-1%2Bbuster_all.deb' # wget $url # dpkg -i zabbix-release_4.5-1+buster_all.deb # apt update -y Instale o zabbix-agent 1 # apt install zabbix-agent zabbix-get -y Configure o agente 1 2 3 4 5 6 7 8 9 10 11 # sed -i 's/Hostname=Zabbix server/Hostname='$(hostname)'/g' zabbix_agentd.conf # sed -i 's/Server=127.0.0.1/Server=zabbix.infra.ifpe.edu.br/g' zabbix_agentd.conf # sed -i 's/ServerActive=127.0.0.1/ServerActive=zabbix.infra.ifpe.edu.br/g' zabbix_agentd.conf # sed -i 's/# LogRemoteCommands=0/LogRemoteCommands=1/g' zabbix_agentd.conf # sed -i 's/# EnableRemoteCommands=0/EnableRemoteCommands=1/g' zabbix_agentd.conf # sed -i 's/# StartAgents=3/StartAgents=3/g' zabbix_agentd.conf Habilite o agente para iniciar no boot do sistema e d\u00ea o start no agente 1 2 # systemctl enable zabbix-agent # systemctl start zabbix-agent","title":"Zabbix"},{"location":"zabbix/#instalacao-do-agente-zabbix-em-servidores-linux-debian","text":"","title":"Instala\u00e7\u00e3o do agente zabbix em servidores Linux Debian"},{"location":"zabbix/#instale-o-repositorio","text":"1 2 3 4 # url='https://repo.zabbix.com/zabbix/4.5/debian/pool/main/z/zabbix-release/zabbix-release_4.5-1%2Bbuster_all.deb' # wget $url # dpkg -i zabbix-release_4.5-1+buster_all.deb # apt update -y","title":"Instale o reposit\u00f3rio"},{"location":"zabbix/#instale-o-zabbix-agent","text":"1 # apt install zabbix-agent zabbix-get -y","title":"Instale o zabbix-agent"},{"location":"zabbix/#configure-o-agente","text":"1 2 3 4 5 6 7 8 9 10 11 # sed -i 's/Hostname=Zabbix server/Hostname='$(hostname)'/g' zabbix_agentd.conf # sed -i 's/Server=127.0.0.1/Server=zabbix.infra.ifpe.edu.br/g' zabbix_agentd.conf # sed -i 's/ServerActive=127.0.0.1/ServerActive=zabbix.infra.ifpe.edu.br/g' zabbix_agentd.conf # sed -i 's/# LogRemoteCommands=0/LogRemoteCommands=1/g' zabbix_agentd.conf # sed -i 's/# EnableRemoteCommands=0/EnableRemoteCommands=1/g' zabbix_agentd.conf # sed -i 's/# StartAgents=3/StartAgents=3/g' zabbix_agentd.conf","title":"Configure o agente"},{"location":"zabbix/#habilite-o-agente-para-iniciar-no-boot-do-sistema-e-de-o-start-no-agente","text":"1 2 # systemctl enable zabbix-agent # systemctl start zabbix-agent","title":"Habilite o agente para iniciar no boot do sistema e d\u00ea o start no agente"}]}